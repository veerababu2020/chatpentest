import openai
import subprocess
import re

# Replace 'YOUR_OPENAI_API_KEY' with your actual API key
openai.api_key = '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'


def generate_domain(prompt):
    response = openai.Completion.create(
        engine="text-davinci-002",
        prompt=prompt,
        max_tokens=100
    )
    generated_domain = response.choices[0].text.strip()

    # Remove "www", "http://", and "https://" from the generated domain
    generated_domain = re.sub(r"(www\.)|(http:\/\/)|(https:\/\/)", "", generated_domain)
    return generated_domain


def get_whois_info(domain_name):
    try:
        result = subprocess.run(["whois", domain_name], capture_output=True, text=True)
        return result.stdout
    except Exception as e:
        return f"Error: {str(e)}"


def main():
    print("Welcome to the WHOIS Information Retrieval Tool with OpenAI!")
    print("Type 'exit' to quit.")

    while True:
        user_input = input("Enter your website name: ")

        if user_input.lower() == 'exit':
            break

        # Use OpenAI to generate the domain name without "www", "http://", or "https://"
        prompt = user_input + " website domain is "
        generated_domain = generate_domain(prompt)
        print("Generated Domain Name:")
        print(generated_domain)

        # Fetch WHOIS information for the generated domain name
        whois_info = get_whois_info(generated_domain)
        print("WHOIS Information:")
        print(whois_info)


if __name__ == "__main__":
    main()
